{% extends "principal/base.html" %}
{% block title %}Edit Course — {{ course.title }}{% endblock %}

{% block content %}
<div class="min-h-full flex flex-col gap-6">

    <!-- ── Breadcrumb ── -->
    <div class="flex items-center gap-2 text-sm">
        <a href="{% url 'manage_courses' %}" class="text-gray-400 hover:text-black font-medium transition flex items-center gap-1.5">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 7h18M3 12h18M3 17h18"/>
            </svg>
            Course Directory
        </a>
        <svg class="w-3.5 h-3.5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"/>
        </svg>
        <span class="text-gray-900 font-semibold truncate max-w-xs">{{ course.title }}</span>
    </div>

    <!-- ── Main card ── -->
    <div class="bg-white/90 backdrop-blur-xl rounded-[2rem] shadow-sm border border-white overflow-hidden">

        <!-- Card top bar -->
        <div class="flex items-center justify-between px-8 py-5 border-b border-gray-100">
            <div class="flex items-center gap-4">
                <!-- Icon badge -->
                <div class="w-11 h-11 rounded-2xl bg-[#FFD384]/25 flex items-center justify-center shrink-0">
                    <svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                </div>
                <div>
                    <h2 class="text-lg font-extrabold text-gray-900">Edit Course</h2>
                    <p class="text-xs text-gray-400 mt-0.5">Updating: <span class="font-semibold text-gray-600">{{ course.title }}</span></p>
                </div>
            </div>

            <!-- Created at badge -->
            <span class="hidden sm:inline-flex items-center gap-1.5 text-xs text-gray-400 font-medium
                         bg-gray-50 border border-gray-100 px-3 py-1.5 rounded-full">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <line x1="16" y1="2" x2="16" y2="6"/>
                    <line x1="8" y1="2" x2="8" y2="6"/>
                    <line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
                Added {{ course.created_at|date:"M d, Y" }}
            </span>
        </div>

        <!-- ── Form ── -->
        <form method="POST" action="{% url 'edit_course' course.pk %}">
            {% csrf_token %}

            <div class="px-8 py-7 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">

                <!-- Course Title (full width) -->
                <div class="md:col-span-2">
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
                        Course Title <span class="text-red-400">*</span>
                    </label>
                    <div class="relative">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-300">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                            </svg>
                        </span>
                        {{ form.title }}
                    </div>
                    {% if form.title.errors %}
                        <p class="text-red-500 text-xs mt-1.5 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="12" y1="8" x2="12" y2="12" stroke="white" stroke-width="2"/>
                                <line x1="12" y1="16" x2="12" y2="16" stroke="white" stroke-width="2"/>
                            </svg>
                            {{ form.title.errors.0 }}
                        </p>
                    {% endif %}
                </div>

                <!-- Department -->
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
                        Department <span class="text-red-400">*</span>
                    </label>
                    <div class="relative">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-300 pointer-events-none">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                            </svg>
                        </span>
                        {{ form.department }}
                    </div>
                    {% if form.department.errors %}
                        <p class="text-red-500 text-xs mt-1.5">{{ form.department.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Price -->
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
                        Price (₹) <span class="text-red-400">*</span>
                    </label>
                    <div class="relative">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold text-sm pointer-events-none">₹</span>
                        {{ form.price }}
                    </div>
                    {% if form.price.errors %}
                        <p class="text-red-500 text-xs mt-1.5">{{ form.price.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Description (full width) -->
                <div class="md:col-span-2">
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
                        Description <span class="text-red-400">*</span>
                    </label>
                    {{ form.description }}
                    {% if form.description.errors %}
                        <p class="text-red-500 text-xs mt-1.5">{{ form.description.errors.0 }}</p>
                    {% endif %}
                </div>

            </div>

            <!-- ── Action bar ── -->
            <div class="px-8 py-5 bg-gray-50 border-t border-gray-100 flex flex-col sm:flex-row items-center justify-between gap-4">

                <!-- Delete shortcut -->
                <button type="button"
                        onclick="document.getElementById('deleteModal').classList.remove('hidden')"
                        class="flex items-center gap-2 text-sm font-bold text-red-400 hover:text-red-600 transition">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                    Delete this course
                </button>

                <div class="flex items-center gap-3">
                    <a href="{% url 'manage_courses' %}"
                       class="px-5 py-2.5 rounded-full text-sm font-bold text-gray-500 hover:bg-gray-100 border border-gray-200 transition">
                        Cancel
                    </a>
                    <button type="submit"
                            class="bg-black text-white px-7 py-2.5 rounded-full text-sm font-bold shadow-lg hover:scale-105 transition-transform flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M5 13l4 4L19 7"/>
                        </svg>
                        Save Changes
                    </button>
                </div>
            </div>

        </form>
    </div>
</div>


<!-- ═══════════════════════════════════════════
     MODAL: Confirm Delete
════════════════════════════════════════════ -->
<div id="deleteModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4"
     style="background:rgba(0,0,0,0.35); backdrop-filter:blur(4px);">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-8 text-center">
        <div class="w-14 h-14 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-7 h-7 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
        </div>
        <h3 class="text-lg font-extrabold text-gray-900 mb-1">Delete Course?</h3>
        <p class="text-sm text-gray-400 mb-6">
            You are about to permanently delete
            <span class="font-bold text-gray-700">"{{ course.title }}"</span>.
            This cannot be undone.
        </p>
        <form method="POST" action="{% url 'delete_course' course.pk %}" class="flex justify-center gap-3">
            {% csrf_token %}
            <button type="button"
                    onclick="document.getElementById('deleteModal').classList.add('hidden')"
                    class="px-5 py-2.5 rounded-full text-sm font-bold text-gray-500 hover:bg-gray-100 border border-gray-200 transition">
                Cancel
            </button>
            <button type="submit"
                    class="bg-red-500 text-white px-6 py-2.5 rounded-full text-sm font-bold hover:bg-red-600 transition">
                Yes, Delete
            </button>
        </form>
    </div>
</div>


<!-- ── Form field styling ── -->
<style>
    /* All inputs, selects, textareas rendered by Django form */
    #id_title, #id_department, #id_price, #id_description {
        width: 100%;
        border: 1.5px solid #e5e7eb;
        border-radius: 12px;
        padding: 10px 14px;
        font-size: 14px;
        font-weight: 500;
        color: #111827;
        background: #f9fafb;
        outline: none;
        transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;
    }
    /* Icon padding for title and price */
    #id_title  { padding-left: 2.5rem; }
    #id_price  { padding-left: 2rem; }
    #id_department { padding-left: 2.5rem; appearance: none; -webkit-appearance: none; }

    #id_title:focus, #id_department:focus,
    #id_price:focus, #id_description:focus {
        border-color: #f97316;
        background: #fff;
        box-shadow: 0 0 0 3px rgba(249,115,22,0.10);
    }
    #id_title:hover:not(:focus), #id_department:hover:not(:focus),
    #id_price:hover:not(:focus),  #id_description:hover:not(:focus) {
        border-color: #d1d5db;
        background: #fff;
    }
    #id_description { resize: vertical; min-height: 96px; }
    #id_department option { background: #fff; }
</style>

{% endblock %}